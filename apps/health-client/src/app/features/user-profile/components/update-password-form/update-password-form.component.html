@let passwordVisible = isPasswordVisible();

<form
  [formGroup]="updatePasswordInfoFormGroup"
  (ngSubmit)="onSubmitUpdatePassword()"
>
  <ion-item-group>
    <ion-item>
      <ion-label position="floating" class="required-to-fill"
        >Старый пароль
      </ion-label>
      <ion-input
        [type]="passwordVisible.oldPassword ? 'text' : 'password'"
        formControlName="oldPassword"
        class="margin-top"
        autocomplete="new-password"
      ></ion-input>
      <ion-icon
        slot="end"
        [name]="passwordVisible.oldPassword ? 'eye-off' : 'eye'"
        (click)="togglePasswordVisibility('oldPassword')"
        class="ion-margin-top cursor-pointer"
      ></ion-icon>

      @if (checkInputValidator(updatePasswordInfoFormGroup, 'oldPassword',
      'required')) {
      <health-error-notification
        [errorNotificationProps]="FORM_VALIDATION_CONSTANT.REQUIRED"
      ></health-error-notification>
      } @if (checkInputValidator(updatePasswordInfoFormGroup, 'oldPassword',
      'minlength')) {
      <health-error-notification
        [errorNotificationProps]="FORM_VALIDATION_CONSTANT.MIN_LENGTH_PASSWORD"
      ></health-error-notification>
      }
    </ion-item>

    <ion-item>
      <ion-label position="floating" class="required-to-fill"
        >Новый пароль <ion-note>(не менее 8-ми символов)</ion-note></ion-label
      >
      <ion-input
        [type]="passwordVisible.newPassword ? 'text' : 'password'"
        formControlName="newPassword"
        class="margin-top"
        autocomplete="new-password"
      ></ion-input>
      <ion-icon
        slot="end"
        [name]="passwordVisible.newPassword ? 'eye-off' : 'eye'"
        (click)="togglePasswordVisibility('newPassword')"
        class="ion-margin-top cursor-pointer"
      ></ion-icon>

      @if (checkInputValidator(updatePasswordInfoFormGroup, 'newPassword',
      'required')) {
      <health-error-notification
        [errorNotificationProps]="FORM_VALIDATION_CONSTANT.REQUIRED"
      ></health-error-notification>
      } @if (checkInputValidator(updatePasswordInfoFormGroup, 'newPassword',
      'minlength')) {
      <health-error-notification
        [errorNotificationProps]="FORM_VALIDATION_CONSTANT.MIN_LENGTH_PASSWORD"
      ></health-error-notification>
      }
    </ion-item>

    <ion-item>
      <ion-label position="floating" class="required-to-fill"
        >Подтверждение нового пароля</ion-label
      >
      <ion-input
        [type]="passwordVisible.newPasswordConfirmation ? 'text' : 'password'"
        formControlName="newPasswordConfirmation"
        class="margin-top"
        autocomplete="new-password"
      ></ion-input>
      <ion-icon
        slot="end"
        [name]="passwordVisible.newPasswordConfirmation ? 'eye-off' : 'eye'"
        (click)="togglePasswordVisibility('newPasswordConfirmation')"
        class="ion-margin-top cursor-pointer"
      ></ion-icon>

      @if (checkInputValidator(updatePasswordInfoFormGroup,
      'newPasswordConfirmation', 'required')) {
      <health-error-notification
        [errorNotificationProps]="FORM_VALIDATION_CONSTANT.REQUIRED"
      ></health-error-notification>
      } @if (checkInputValidator(updatePasswordInfoFormGroup,
      'newPasswordConfirmation', 'minlength')) {
      <health-error-notification
        [errorNotificationProps]="FORM_VALIDATION_CONSTANT.MIN_LENGTH_PASSWORD"
      ></health-error-notification>
      }
    </ion-item>
    <ion-item lines="none" class="ion-margin-top">
      <health-action-button
        [configProps]="{
        isFormButton: true,
        label: 'сохранить',
        isDisabled: updatePasswordInfoFormGroup.invalid || isSubmittingForm(),
        routerLink: null,
      }"
      ></health-action-button>
    </ion-item>
  </ion-item-group>
</form>
